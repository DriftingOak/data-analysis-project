<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="refresh" content="360">
<title>Polymarket Geopolitical Bot</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Outfit:wght@300;400;600;700&display=swap');

:root {
  --bg: #0a0a12;
  --bg2: #12121e;
  --bg3: #1a1a2c;
  --bg-hover: #22223a;
  --border: #2a2a42;
  --text: #c8c8d8;
  --text2: #7878a0;
  --accent: #5ee8b7;
  --accent2: #3db896;
  --pos: #5ee8b7;
  --neg: #f06888;
  --warn: #f0c060;
  --blue: #60a0f0;
}

* { margin:0; padding:0; box-sizing:border-box; }
body { background:var(--bg); color:var(--text); font-family:'Outfit',sans-serif; font-size:14px; }

.wrap { max-width:1440px; margin:0 auto; padding:24px; }

/* ── Header ── */
header { display:flex; justify-content:space-between; align-items:baseline; margin-bottom:28px; flex-wrap:wrap; gap:12px; }
header h1 { font-size:1.6em; font-weight:700; color:#fff; letter-spacing:-0.02em; }
header h1 span { color:var(--accent); }
.updated { font-size:0.82em; color:var(--text2); }

/* ── Aggregate bar ── */
.agg { display:flex; gap:32px; padding:16px 24px; background:var(--bg2); border:1px solid var(--border); border-radius:10px; margin-bottom:24px; flex-wrap:wrap; }
.agg-item { text-align:center; }
.agg-val { display:block; font-family:'JetBrains Mono',monospace; font-size:1.3em; font-weight:700; }
.agg-lbl { font-size:0.72em; color:var(--text2); text-transform:uppercase; letter-spacing:0.06em; }

/* ── Tier filters ── */
.filters { display:flex; gap:6px; margin-bottom:16px; flex-wrap:wrap; }
.filter-btn {
  background:var(--bg2); border:1px solid var(--border); color:var(--text2);
  padding:5px 14px; border-radius:6px; font-size:0.78em; cursor:pointer;
  font-family:'Outfit',sans-serif; transition:all .15s;
}
.filter-btn:hover { border-color:var(--accent); color:var(--text); }
.filter-btn.active { background:var(--accent); color:var(--bg); border-color:var(--accent); font-weight:600; }

/* ── Comparison table ── */
.comp-wrap { overflow-x:auto; margin-bottom:8px; }
.comp { width:100%; border-collapse:collapse; font-size:0.85em; }
.comp th {
  text-align:left; padding:8px 10px; color:var(--text2); font-weight:600;
  border-bottom:2px solid var(--border); cursor:pointer; white-space:nowrap;
  font-size:0.78em; text-transform:uppercase; letter-spacing:0.04em;
  user-select:none; position:sticky; top:0; background:var(--bg);
}
.comp th:hover { color:var(--accent); }
.comp th.sorted-asc::after { content:" ▲"; font-size:0.65em; }
.comp th.sorted-desc::after { content:" ▼"; font-size:0.65em; }
.comp td {
  padding:7px 10px; border-bottom:1px solid var(--border);
  font-family:'JetBrains Mono',monospace; font-size:0.92em; white-space:nowrap;
}
.comp tr { cursor:pointer; transition:background .1s; }
.comp tr:hover { background:var(--bg-hover); }
.comp tr.expanded { background:var(--bg3); }
.strat-name { font-family:'Outfit',sans-serif; font-weight:600; color:#fff; }

.tier-dot { display:inline-block; width:8px; height:8px; border-radius:50%; margin-right:6px; }
.tier-base { background:#7878a0; }
.tier-t1 { background:#60a0f0; }
.tier-t2 { background:#f0c060; }
.tier-t3 { background:#c080f0; }
.tier-t4 { background:#f08060; }
.tier-t5 { background:#5ee8b7; }
.tier-other { background:#555; }

.pos { color:var(--pos); }
.neg { color:var(--neg); }

/* ── Chart ── */
.chart-section { margin:28px 0; }
.chart-section h2 { font-size:1.1em; margin-bottom:12px; color:#fff; }
#chart { width:100%; height:260px; background:var(--bg2); border:1px solid var(--border); border-radius:10px; }

/* ── Detail panels ── */
.detail-panel {
  background:var(--bg2); border:1px solid var(--border); border-radius:10px;
  margin-bottom:6px; overflow:hidden; animation:slideDown .2s ease;
}
@keyframes slideDown { from { opacity:0; max-height:0; } to { opacity:1; max-height:2000px; } }
.detail-header { padding:16px 20px 8px; }
.detail-header h3 { font-size:1em; color:#fff; }
.desc { color:var(--text2); font-size:0.82em; margin:2px 0 6px; }
.detail-meta { font-size:0.78em; color:var(--text2); }

.detail-tabs { padding:0 20px; display:flex; gap:4px; }
.tab-btn {
  background:none; border:none; color:var(--text2); padding:8px 16px;
  font-family:'Outfit',sans-serif; font-size:0.82em; cursor:pointer;
  border-bottom:2px solid transparent; transition:all .15s;
}
.tab-btn:hover { color:var(--text); }
.tab-btn.active { color:var(--accent); border-bottom-color:var(--accent); }

.tab-content { padding:0 20px 16px; }
.pos-table { width:100%; border-collapse:collapse; font-size:0.8em; margin-top:8px; }
.pos-table th { text-align:left; padding:6px 8px; color:var(--text2); font-weight:500; font-size:0.82em; border-bottom:1px solid var(--border); }
.pos-table td { padding:5px 8px; border-bottom:1px solid rgba(42,42,66,0.5); font-family:'JetBrains Mono',monospace; font-size:0.9em; }
.q-cell { font-family:'Outfit',sans-serif; max-width:300px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.q-cell a { color:var(--blue); text-decoration:none; }
.q-cell a:hover { text-decoration:underline; }

.badge { padding:2px 7px; border-radius:3px; font-size:0.78em; font-weight:600; }
.badge-no { background:rgba(240,104,136,0.15); color:var(--neg); }
.badge-yes { background:rgba(94,232,183,0.15); color:var(--pos); }
.badge-win { background:rgba(94,232,183,0.15); color:var(--pos); }
.badge-lose { background:rgba(240,104,136,0.15); color:var(--neg); }

.tag { display:inline-block; padding:1px 8px; background:var(--bg3); border-radius:3px; font-size:0.78em; margin:0 3px; }
.empty { color:var(--text2); font-size:0.85em; padding:16px 0; }

/* ── Responsive ── */
@media (max-width:768px) {
  .agg { gap:16px; }
  .agg-val { font-size:1em; }
  .comp { font-size:0.75em; }
  .q-cell { max-width:160px; }
}
</style>
</head>
<body>
<div class="wrap">

<header>
  <h1><span>▲</span> Polymarket Geopolitical Bot</h1>
  <span class="updated">2026-02-08 22:10 UTC · auto-refresh 6min</span>
</header>

<div class="agg">
  <div class="agg-item"><span class="agg-val">4</span><span class="agg-lbl">Strategies</span></div>
  <div class="agg-item"><span class="agg-val pos">$+21</span><span class="agg-lbl">Realized P&L</span></div>
  <div class="agg-item"><span class="agg-val pos">$+0</span><span class="agg-lbl">Unrealized</span></div>
  <div class="agg-item"><span class="agg-val">4</span><span class="agg-lbl">Open</span></div>
  <div class="agg-item"><span class="agg-val">4</span><span class="agg-lbl">Closed</span></div>
  <div class="agg-item"><span class="agg-val">100%</span><span class="agg-lbl">Win Rate (4W/0L)</span></div>
</div>

<div class="chart-section">
  <h2>P&L History</h2>
  <canvas id="chart"></canvas>
</div>

<div class="filters"><button class="filter-btn active" data-tier="all">All</button><button class="filter-btn" data-tier="base">Base (legacy)</button><button class="filter-btn" data-tier="t1">Tier 1 — Controls</button><button class="filter-btn" data-tier="t2">Tier 2 — Volume Hypothesis</button><button class="filter-btn" data-tier="t5">Tier 5 — Deployable</button></div>

<div class="comp-wrap">
<table class="comp" id="compTable">
<thead><tr>
  <th data-col="0" data-type="str">Strategy</th>
  <th data-col="1" data-type="num">Realized</th>
  <th data-col="2" data-type="num">Total P&L</th>
  <th data-col="3" data-type="num">ROI</th>
  <th data-col="4" data-type="num">Win Rate</th>
  <th data-col="5" data-type="num">W/L</th>
  <th data-col="6" data-type="num">Open</th>
  <th data-col="7" data-type="num">Exposure</th>
</tr></thead>
<tbody><tr data-tier="base" onclick="toggleDetail('balanced')">
<td class="strat-name"><span class="tier-dot tier-base"></span>Balanced</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="0.1">+0.1%</td>
<td class="pos" data-v="100.0">100%</td>
<td data-v="1">1W/0L</td>
<td data-v="1">1</td>
<td data-v="1">1%</td>
</tr>
<tr data-tier="t1" onclick="toggleDetail('t1_signal_exists')">
<td class="strat-name"><span class="tier-dot tier-t1"></span>t1_signal_exists</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="0.1">+0.1%</td>
<td class="pos" data-v="100.0">100%</td>
<td data-v="1">1W/0L</td>
<td data-v="1">1</td>
<td data-v="1">1%</td>
</tr>
<tr data-tier="t2" onclick="toggleDetail('t2_low_volume')">
<td class="strat-name"><span class="tier-dot tier-t2"></span>t2_low_volume</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="0.1">+0.1%</td>
<td class="pos" data-v="100.0">100%</td>
<td data-v="1">1W/0L</td>
<td data-v="1">1</td>
<td data-v="1">1%</td>
</tr>
<tr data-tier="t5" onclick="toggleDetail('t5_deploy_conservative')">
<td class="strat-name"><span class="tier-dot tier-t5"></span>t5_deploy_conservative</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="5.3">$+5</td>
<td class="pos" data-v="0.1">+0.1%</td>
<td class="pos" data-v="100.0">100%</td>
<td data-v="1">1W/0L</td>
<td data-v="1">1</td>
<td data-v="0">0%</td>
</tr>
</tbody>
</table>
</div>


<div class="detail-panel" id="detail-balanced" style="display:none">
  <div class="detail-header">
    <h3>Balanced</h3>
    <p class="desc">Balanced risk/reward - the baseline strategy from backtest</p>
    <div class="detail-meta">
      Bankroll: $4,980 | Exposure: $25 (1%)
       | Clusters: <span class="tag">mideast: $25</span>
    </div>
  </div>
  <div class="detail-tabs">
    <button class="tab-btn active" onclick="switchTab('balanced','open')">Open (1)</button>
    <button class="tab-btn" onclick="switchTab('balanced','closed')">Closed (1)</button>
  </div>
  <div class="tab-content" id="tab-balanced-open">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Current</th><th>P&L</th><th>Size</th><th>Cluster</th><th>Entry</th><th>Exp. Close</th>
    </tr></thead><tbody><tr>
<td class="q-cell"><a href="#" target="_blank">Will Iran strike Israel before March 2026?</a></td>
<td><span class="badge badge-no">NO</span></td>
<td>25%</td><td>—</td>
<td class="">—</td>
<td>$25</td><td>mideast</td><td>2026-02-01</td><td>2026-03-01</td>
</tr>
</tbody></table>
  </div>
  <div class="tab-content" id="tab-balanced-closed" style="display:none">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Result</th><th>P&L</th><th>Size</th><th>Entry</th><th>Closed</th>
    </tr></thead><tbody><tr>
<td class="q-cell">Will Russia capture Kharkiv by Feb 2026?</td>
<td><span class="badge badge-no">NO</span></td>
<td>20%</td>
<td class="pos"><span class="badge badge-win">win</span></td>
<td class="pos">$+5</td>
<td>$25</td><td>2026-01-15</td><td>2026-02-01</td>
</tr>
</tbody></table>
  </div>
</div>

<div class="detail-panel" id="detail-t1_signal_exists" style="display:none">
  <div class="detail-header">
    <h3>t1_signal_exists</h3>
    <p class="desc"></p>
    <div class="detail-meta">
      Bankroll: $4,980 | Exposure: $25 (1%)
       | Clusters: <span class="tag">mideast: $25</span>
    </div>
  </div>
  <div class="detail-tabs">
    <button class="tab-btn active" onclick="switchTab('t1_signal_exists','open')">Open (1)</button>
    <button class="tab-btn" onclick="switchTab('t1_signal_exists','closed')">Closed (1)</button>
  </div>
  <div class="tab-content" id="tab-t1_signal_exists-open">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Current</th><th>P&L</th><th>Size</th><th>Cluster</th><th>Entry</th><th>Exp. Close</th>
    </tr></thead><tbody><tr>
<td class="q-cell"><a href="#" target="_blank">Will Iran strike Israel before March 2026?</a></td>
<td><span class="badge badge-no">NO</span></td>
<td>25%</td><td>—</td>
<td class="">—</td>
<td>$25</td><td>mideast</td><td>2026-02-01</td><td>2026-03-01</td>
</tr>
</tbody></table>
  </div>
  <div class="tab-content" id="tab-t1_signal_exists-closed" style="display:none">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Result</th><th>P&L</th><th>Size</th><th>Entry</th><th>Closed</th>
    </tr></thead><tbody><tr>
<td class="q-cell">Will Russia capture Kharkiv by Feb 2026?</td>
<td><span class="badge badge-no">NO</span></td>
<td>20%</td>
<td class="pos"><span class="badge badge-win">win</span></td>
<td class="pos">$+5</td>
<td>$25</td><td>2026-01-15</td><td>2026-02-01</td>
</tr>
</tbody></table>
  </div>
</div>

<div class="detail-panel" id="detail-t2_low_volume" style="display:none">
  <div class="detail-header">
    <h3>t2_low_volume</h3>
    <p class="desc"></p>
    <div class="detail-meta">
      Bankroll: $4,980 | Exposure: $25 (1%)
       | Clusters: <span class="tag">mideast: $25</span>
    </div>
  </div>
  <div class="detail-tabs">
    <button class="tab-btn active" onclick="switchTab('t2_low_volume','open')">Open (1)</button>
    <button class="tab-btn" onclick="switchTab('t2_low_volume','closed')">Closed (1)</button>
  </div>
  <div class="tab-content" id="tab-t2_low_volume-open">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Current</th><th>P&L</th><th>Size</th><th>Cluster</th><th>Entry</th><th>Exp. Close</th>
    </tr></thead><tbody><tr>
<td class="q-cell"><a href="#" target="_blank">Will Iran strike Israel before March 2026?</a></td>
<td><span class="badge badge-no">NO</span></td>
<td>25%</td><td>—</td>
<td class="">—</td>
<td>$25</td><td>mideast</td><td>2026-02-01</td><td>2026-03-01</td>
</tr>
</tbody></table>
  </div>
  <div class="tab-content" id="tab-t2_low_volume-closed" style="display:none">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Result</th><th>P&L</th><th>Size</th><th>Entry</th><th>Closed</th>
    </tr></thead><tbody><tr>
<td class="q-cell">Will Russia capture Kharkiv by Feb 2026?</td>
<td><span class="badge badge-no">NO</span></td>
<td>20%</td>
<td class="pos"><span class="badge badge-win">win</span></td>
<td class="pos">$+5</td>
<td>$25</td><td>2026-01-15</td><td>2026-02-01</td>
</tr>
</tbody></table>
  </div>
</div>

<div class="detail-panel" id="detail-t5_deploy_conservative" style="display:none">
  <div class="detail-header">
    <h3>t5_deploy_conservative</h3>
    <p class="desc">Min risk, max ROI/DD (8.7x). Micro focus, skip >250k. Backtest: +31.4%, DD 3.6%</p>
    <div class="detail-meta">
      Bankroll: $5,050 | Exposure: $25 (0%)
       | Clusters: <span class="tag">mideast: $25</span>
    </div>
  </div>
  <div class="detail-tabs">
    <button class="tab-btn active" onclick="switchTab('t5_deploy_conservative','open')">Open (1)</button>
    <button class="tab-btn" onclick="switchTab('t5_deploy_conservative','closed')">Closed (1)</button>
  </div>
  <div class="tab-content" id="tab-t5_deploy_conservative-open">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Current</th><th>P&L</th><th>Size</th><th>Cluster</th><th>Entry</th><th>Exp. Close</th>
    </tr></thead><tbody><tr>
<td class="q-cell"><a href="#" target="_blank">Will Iran strike Israel before March 2026?</a></td>
<td><span class="badge badge-no">NO</span></td>
<td>25%</td><td>—</td>
<td class="">—</td>
<td>$25</td><td>mideast</td><td>2026-02-01</td><td>2026-03-01</td>
</tr>
</tbody></table>
  </div>
  <div class="tab-content" id="tab-t5_deploy_conservative-closed" style="display:none">
    <table class="pos-table"><thead><tr>
    <th>Market</th><th>Side</th><th>Entry YES</th><th>Result</th><th>P&L</th><th>Size</th><th>Entry</th><th>Closed</th>
    </tr></thead><tbody><tr>
<td class="q-cell">Will Russia capture Kharkiv by Feb 2026?</td>
<td><span class="badge badge-no">NO</span></td>
<td>20%</td>
<td class="pos"><span class="badge badge-win">win</span></td>
<td class="pos">$+5</td>
<td>$25</td><td>2026-01-15</td><td>2026-02-01</td>
</tr>
</tbody></table>
  </div>
</div>


</div>

<script>
// ── P&L Chart (lightweight canvas) ──
const history = [{"ts": "2026-02-08T22:10:08Z", "strategies": {"balanced": {"realized": 5.3, "unrealized": 0, "total": 5.3, "open": 1, "wins": 1, "losses": 0}, "t1_signal_exists": {"realized": 5.3, "unrealized": 0, "total": 5.3, "open": 1, "wins": 1, "losses": 0}, "t2_low_volume": {"realized": 5.3, "unrealized": 0, "total": 5.3, "open": 1, "wins": 1, "losses": 0}, "t5_deploy_conservative": {"realized": 5.3, "unrealized": 0, "total": 5.3, "open": 1, "wins": 1, "losses": 0}}}];
function drawChart() {
  const canvas = document.getElementById('chart');
  if (!canvas || !history.length) return;
  const ctx = canvas.getContext('2d');
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();
  canvas.width = rect.width * dpr;
  canvas.height = rect.height * dpr;
  ctx.scale(dpr, dpr);
  const W = rect.width, H = rect.height;
  const pad = {t:20, r:20, b:30, l:60};
  const cW = W - pad.l - pad.r, cH = H - pad.t - pad.b;

  // Aggregate total P&L per timestamp
  const points = history.map(h => {
    let total = 0;
    for (const s of Object.values(h.strategies)) total += (s.total || 0);
    return { ts: h.ts, val: total };
  });

  if (points.length < 2) {
    ctx.fillStyle = '#7878a0';
    ctx.font = '13px Outfit';
    ctx.fillText('Need more data points...', W/2 - 70, H/2);
    return;
  }

  const vals = points.map(p => p.val);
  let minV = Math.min(...vals, 0);
  let maxV = Math.max(...vals, 0);
  if (minV === maxV) { minV -= 10; maxV += 10; }
  const rangeV = maxV - minV;

  // Grid
  ctx.strokeStyle = '#2a2a42';
  ctx.lineWidth = 0.5;
  for (let i = 0; i <= 4; i++) {
    const y = pad.t + (cH / 4) * i;
    ctx.beginPath(); ctx.moveTo(pad.l, y); ctx.lineTo(W - pad.r, y); ctx.stroke();
    const v = maxV - (rangeV / 4) * i;
    ctx.fillStyle = '#7878a0'; ctx.font = '11px JetBrains Mono';
    ctx.textAlign = 'right';
    ctx.fillText('$' + v.toFixed(0), pad.l - 8, y + 4);
  }

  // Zero line
  if (minV < 0 && maxV > 0) {
    const zeroY = pad.t + ((maxV - 0) / rangeV) * cH;
    ctx.strokeStyle = '#4a4a6a'; ctx.lineWidth = 1; ctx.setLineDash([4,4]);
    ctx.beginPath(); ctx.moveTo(pad.l, zeroY); ctx.lineTo(W - pad.r, zeroY); ctx.stroke();
    ctx.setLineDash([]);
  }

  // Line
  ctx.beginPath();
  ctx.strokeStyle = points[points.length-1].val >= 0 ? '#5ee8b7' : '#f06888';
  ctx.lineWidth = 2;
  ctx.lineJoin = 'round';
  for (let i = 0; i < points.length; i++) {
    const x = pad.l + (i / (points.length - 1)) * cW;
    const y = pad.t + ((maxV - points[i].val) / rangeV) * cH;
    if (i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
  }
  ctx.stroke();

  // Fill
  const lastX = pad.l + cW;
  const zeroY = pad.t + ((maxV - 0) / rangeV) * cH;
  ctx.lineTo(lastX, zeroY);
  ctx.lineTo(pad.l, zeroY);
  ctx.closePath();
  const grad = ctx.createLinearGradient(0, pad.t, 0, pad.t + cH);
  if (points[points.length-1].val >= 0) {
    grad.addColorStop(0, 'rgba(94,232,183,0.15)');
    grad.addColorStop(1, 'rgba(94,232,183,0)');
  } else {
    grad.addColorStop(0, 'rgba(240,104,136,0)');
    grad.addColorStop(1, 'rgba(240,104,136,0.15)');
  }
  ctx.fillStyle = grad;
  ctx.fill();

  // X-axis dates
  ctx.fillStyle = '#7878a0'; ctx.font = '10px JetBrains Mono'; ctx.textAlign = 'center';
  const step = Math.max(1, Math.floor(points.length / 6));
  for (let i = 0; i < points.length; i += step) {
    const x = pad.l + (i / (points.length - 1)) * cW;
    const d = points[i].ts.substring(5, 10);
    ctx.fillText(d, x, H - 8);
  }
}
drawChart();
window.addEventListener('resize', drawChart);

// ── Table sorting ──
document.querySelectorAll('.comp th').forEach(th => {
  th.addEventListener('click', () => {
    const table = document.getElementById('compTable');
    const tbody = table.querySelector('tbody');
    const rows = Array.from(tbody.querySelectorAll('tr'));
    const col = parseInt(th.dataset.col);
    const isNum = th.dataset.type === 'num';
    const asc = th.classList.contains('sorted-asc');

    table.querySelectorAll('th').forEach(h => h.classList.remove('sorted-asc','sorted-desc'));
    th.classList.add(asc ? 'sorted-desc' : 'sorted-asc');

    rows.sort((a, b) => {
      let av, bv;
      if (isNum) {
        av = parseFloat(a.children[col]?.dataset?.v || a.children[col]?.textContent) || 0;
        bv = parseFloat(b.children[col]?.dataset?.v || b.children[col]?.textContent) || 0;
      } else {
        av = a.children[col]?.textContent || '';
        bv = b.children[col]?.textContent || '';
      }
      return asc ? (av < bv ? -1 : 1) : (av > bv ? -1 : 1);
    });
    rows.forEach(r => tbody.appendChild(r));
  });
});

// ── Tier filters ──
document.querySelectorAll('.filter-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    const tier = btn.dataset.tier;
    document.querySelectorAll('.comp tbody tr').forEach(row => {
      row.style.display = (tier === 'all' || row.dataset.tier === tier) ? '' : 'none';
    });
    // Also hide detail panels
    document.querySelectorAll('.detail-panel').forEach(p => p.style.display = 'none');
    document.querySelectorAll('.comp tbody tr').forEach(r => r.classList.remove('expanded'));
  });
});

// ── Expand/collapse detail ──
function toggleDetail(key) {
  const panel = document.getElementById('detail-' + key);
  const row = document.querySelector(`tr[onclick*="${key}"]`);
  if (!panel) return;
  const visible = panel.style.display !== 'none';
  // Close all
  document.querySelectorAll('.detail-panel').forEach(p => p.style.display = 'none');
  document.querySelectorAll('.comp tbody tr').forEach(r => r.classList.remove('expanded'));
  if (!visible) {
    panel.style.display = 'block';
    if (row) row.classList.add('expanded');
    panel.scrollIntoView({ behavior:'smooth', block:'nearest' });
  }
}

// ── Tabs ──
function switchTab(key, tab) {
  const panel = document.getElementById('detail-' + key);
  if (!panel) return;
  panel.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
  panel.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + key + '-' + tab).style.display = 'block';
  event.target.classList.add('active');
}
</script>
</body>
</html>